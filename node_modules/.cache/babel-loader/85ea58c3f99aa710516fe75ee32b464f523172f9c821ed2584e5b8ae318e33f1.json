{"ast":null,"code":"// 쿠팡 파트너스 API 클라이언트 클래스\nclass CoupangPartnerService{constructor(){this.partnerId=void 0;this.functionsUrl=void 0;this.partnerId=process.env.REACT_APP_COUPANG_PARTNER_ID||'';// 개발 환경과 프로덕션 환경에 따라 다른 URL 사용\nthis.functionsUrl=process.env.NODE_ENV==='production'?'/.netlify/functions':'http://localhost:8888/.netlify/functions';}// 제품 검색 API 호출 (Netlify Functions 통해)\nasync searchProducts(keyword){let limit=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10;try{const response=await fetch(`${this.functionsUrl}/coupang-search`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({keyword,limit})});if(!response.ok){throw new Error(`HTTP error! status: ${response.status}`);}const data=await response.json();if(data.error){throw new Error(data.error);}return data;}catch(error){console.error('쿠팡 제품 검색 오류:',error);// 오류 발생 시 더미 데이터 반환\nreturn this.getDummyProducts(keyword,limit);}}// 더미 제품 데이터 생성 (백업용)\ngetDummyProducts(keyword,limit){const products=[{productId:'1',productName:`${keyword} 관련 제품 1`,productPrice:59000,productImage:`https://via.placeholder.com/300x200?text=${encodeURIComponent(keyword)}1`,productUrl:`https://www.coupang.com/vp/products/1?vendorItemId=1&src=1036296&spec=10304982`,originalPrice:79000,discountRate:25,vendorItemId:'1',categoryName:'생활용품',rating:4.5,ratingCount:128},{productId:'2',productName:`${keyword} 관련 제품 2`,productPrice:89000,productImage:`https://via.placeholder.com/300x200?text=${encodeURIComponent(keyword)}2`,productUrl:`https://www.coupang.com/vp/products/2?vendorItemId=2&src=1036296&spec=10304982`,originalPrice:109000,discountRate:18,vendorItemId:'2',categoryName:'패션',rating:4.2,ratingCount:89},{productId:'3',productName:`${keyword} 관련 제품 3`,productPrice:79000,productImage:`https://via.placeholder.com/300x200?text=${encodeURIComponent(keyword)}3`,productUrl:`https://www.coupang.com/vp/products/3?vendorItemId=3&src=1036296&spec=10304982`,originalPrice:99000,discountRate:20,vendorItemId:'3',categoryName:'IT기기',rating:4.7,ratingCount:256}];return{products:products.slice(0,limit),totalCount:products.length};}// 파트너스 링크 생성\ngeneratePartnerLink(productUrl){if(!this.partnerId){console.warn('쿠팡 파트너 ID가 설정되지 않았습니다. 기본 링크를 반환합니다.');return productUrl;}const partnerCode=this.partnerId;const encodedUrl=encodeURIComponent(productUrl);return`https://link.coupang.com/a/${partnerCode}?url=${encodedUrl}`;}// 검색 링크 생성 (백업용)\ngenerateSearchLink(keyword){if(!this.partnerId){return`https://www.coupang.com/np/search?q=${encodeURIComponent(keyword)}`;}const partnerCode=this.partnerId;const encodedKeyword=encodeURIComponent(keyword);return`https://link.coupang.com/a/${partnerCode}?url=https%3A%2F%2Fwww.coupang.com%2Fnp%2Fsearch%3Fq%3D${encodedKeyword}`;}}export const coupangService=new CoupangPartnerService();","map":{"version":3,"names":["CoupangPartnerService","constructor","partnerId","functionsUrl","process","env","REACT_APP_COUPANG_PARTNER_ID","NODE_ENV","searchProducts","keyword","limit","arguments","length","undefined","response","fetch","method","headers","body","JSON","stringify","ok","Error","status","data","json","error","console","getDummyProducts","products","productId","productName","productPrice","productImage","encodeURIComponent","productUrl","originalPrice","discountRate","vendorItemId","categoryName","rating","ratingCount","slice","totalCount","generatePartnerLink","warn","partnerCode","encodedUrl","generateSearchLink","encodedKeyword","coupangService"],"sources":["C:/Users/NT940XHA/OneDrive/Business/ai automation/CoupleGift/src/services/coupangService.ts"],"sourcesContent":["interface CoupangProduct {\r\n  productId: string;\r\n  productName: string;\r\n  productPrice: number;\r\n  productImage: string;\r\n  productUrl: string;\r\n  originalPrice: number;\r\n  discountRate: number;\r\n  vendorItemId: string;\r\n  categoryName: string;\r\n  rating: number;\r\n  ratingCount: number;\r\n}\r\n\r\ninterface CoupangSearchResponse {\r\n  products: CoupangProduct[];\r\n  totalCount: number;\r\n}\r\n\r\n// 쿠팡 파트너스 API 클라이언트 클래스\r\nclass CoupangPartnerService {\r\n  private readonly partnerId: string;\r\n  private readonly functionsUrl: string;\r\n\r\n  constructor() {\r\n    this.partnerId = process.env.REACT_APP_COUPANG_PARTNER_ID || '';\r\n    // 개발 환경과 프로덕션 환경에 따라 다른 URL 사용\r\n    this.functionsUrl = process.env.NODE_ENV === 'production' \r\n      ? '/.netlify/functions' \r\n      : 'http://localhost:8888/.netlify/functions';\r\n  }\r\n\r\n  // 제품 검색 API 호출 (Netlify Functions 통해)\r\n  async searchProducts(keyword: string, limit: number = 10): Promise<CoupangSearchResponse> {\r\n    try {\r\n      const response = await fetch(`${this.functionsUrl}/coupang-search`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          keyword,\r\n          limit\r\n        })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      \r\n      if (data.error) {\r\n        throw new Error(data.error);\r\n      }\r\n\r\n      return data;\r\n      \r\n    } catch (error) {\r\n      console.error('쿠팡 제품 검색 오류:', error);\r\n      \r\n      // 오류 발생 시 더미 데이터 반환\r\n      return this.getDummyProducts(keyword, limit);\r\n    }\r\n  }\r\n\r\n  // 더미 제품 데이터 생성 (백업용)\r\n  private getDummyProducts(keyword: string, limit: number): CoupangSearchResponse {\r\n    const products: CoupangProduct[] = [\r\n      {\r\n        productId: '1',\r\n        productName: `${keyword} 관련 제품 1`,\r\n        productPrice: 59000,\r\n        productImage: `https://via.placeholder.com/300x200?text=${encodeURIComponent(keyword)}1`,\r\n        productUrl: `https://www.coupang.com/vp/products/1?vendorItemId=1&src=1036296&spec=10304982`,\r\n        originalPrice: 79000,\r\n        discountRate: 25,\r\n        vendorItemId: '1',\r\n        categoryName: '생활용품',\r\n        rating: 4.5,\r\n        ratingCount: 128\r\n      },\r\n      {\r\n        productId: '2',\r\n        productName: `${keyword} 관련 제품 2`,\r\n        productPrice: 89000,\r\n        productImage: `https://via.placeholder.com/300x200?text=${encodeURIComponent(keyword)}2`,\r\n        productUrl: `https://www.coupang.com/vp/products/2?vendorItemId=2&src=1036296&spec=10304982`,\r\n        originalPrice: 109000,\r\n        discountRate: 18,\r\n        vendorItemId: '2',\r\n        categoryName: '패션',\r\n        rating: 4.2,\r\n        ratingCount: 89\r\n      },\r\n      {\r\n        productId: '3',\r\n        productName: `${keyword} 관련 제품 3`,\r\n        productPrice: 79000,\r\n        productImage: `https://via.placeholder.com/300x200?text=${encodeURIComponent(keyword)}3`,\r\n        productUrl: `https://www.coupang.com/vp/products/3?vendorItemId=3&src=1036296&spec=10304982`,\r\n        originalPrice: 99000,\r\n        discountRate: 20,\r\n        vendorItemId: '3',\r\n        categoryName: 'IT기기',\r\n        rating: 4.7,\r\n        ratingCount: 256\r\n      }\r\n    ];\r\n\r\n    return {\r\n      products: products.slice(0, limit),\r\n      totalCount: products.length\r\n    };\r\n  }\r\n\r\n  // 파트너스 링크 생성\r\n  generatePartnerLink(productUrl: string): string {\r\n    if (!this.partnerId) {\r\n      console.warn('쿠팡 파트너 ID가 설정되지 않았습니다. 기본 링크를 반환합니다.');\r\n      return productUrl;\r\n    }\r\n\r\n    const partnerCode = this.partnerId;\r\n    const encodedUrl = encodeURIComponent(productUrl);\r\n    \r\n    return `https://link.coupang.com/a/${partnerCode}?url=${encodedUrl}`;\r\n  }\r\n\r\n  // 검색 링크 생성 (백업용)\r\n  generateSearchLink(keyword: string): string {\r\n    if (!this.partnerId) {\r\n      return `https://www.coupang.com/np/search?q=${encodeURIComponent(keyword)}`;\r\n    }\r\n\r\n    const partnerCode = this.partnerId;\r\n    const encodedKeyword = encodeURIComponent(keyword);\r\n    \r\n    return `https://link.coupang.com/a/${partnerCode}?url=https%3A%2F%2Fwww.coupang.com%2Fnp%2Fsearch%3Fq%3D${encodedKeyword}`;\r\n  }\r\n}\r\n\r\nexport const coupangService = new CoupangPartnerService();\r\nexport type { CoupangProduct, CoupangSearchResponse }; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}